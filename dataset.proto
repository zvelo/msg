syntax = "proto3";

package msg;

option go_package = "zvelo.io/msg";

import "zvelo.io/msg/category.proto";

enum DataSetType {
  CATEGORIZATION = 0;
  ADFRAUD        = 1;
  // 2 is reserved
  KEYWORD        = 3;
  MALICIOUS      = 4;
  ECHO           = 5; // for internal zvelo use only
  SENTIMENT      = 6; // returns keywords & sentiment
}

message DataSet {
  message Categorization {
    repeated Category category = 1;
  }

  message AdFraud {
    bool   fraud     = 1;
    string signature = 2;
  }

  message Sentiment {
    float score = 1;
  }

  message Malicious {
    Category category  = 1;
    string   signature = 2;
    bool     verdict   = 3;
  }

  message Echo {
    string url = 1;
  }

  Categorization         categorization = 1;
  AdFraud                adfraud        = 2;
  // 3 is reserved
  // if SENTIMENT is not requested, keywords will map to nil values  
  map<string, Sentiment> keyword        = 4;
  Malicious              malicious      = 5;
  Echo                   echo           = 6;
}
